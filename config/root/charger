### echo "USB and Power input"
### echo "==================="

case "$(uname -r)" in

2.6.* )

echo "Main battery"
echo "============"
echo type: $(cat /sys/bus/platform/devices/twl4030-bci-battery/power_supply/twl4030_bci_battery/type)
echo status: $(cat /sys/bus/platform/devices/twl4030-bci-battery/power_supply/twl4030_bci_battery/status)
echo volt: $(cat /sys/bus/platform/devices/twl4030-bci-battery/power_supply/twl4030_bci_battery/voltage_now)mV
echo current: $(cat /sys/bus/platform/devices/twl4030-bci-battery/power_supply/twl4030_bci_battery/current_now)mA
echo online: $(cat /sys/bus/platform/devices/twl4030-bci-battery/power_supply/twl4030_bci_battery/online)
echo temp: $(cat /sys/bus/platform/devices/twl4030-bci-battery/power_supply/twl4030_bci_battery/temp)°C

echo
echo "Backup battery"
echo "=============="
echo type: $(cat /sys/bus/platform/devices/twl4030-bci-battery/power_supply/twl4030_bci_bk_battery/type)
# echo status: $(cat /sys/bus/platform/devices/twl4030-bci-battery/power_supply/twl4030_bci_bk_battery/status)
echo volt: $(cat /sys/bus/platform/devices/twl4030-bci-battery/power_supply/twl4030_bci_bk_battery/voltage_now)mV
;;

3.?.* | 3.10.* | 3.11.* | 3.12.* | 3.13.* )

echo "USB Charger"
echo "============"
echo online: $(cat /sys/class/power_supply/twl4030_usb/online 2>/dev/null)
echo type: $(cat /sys/class/power_supply/twl4030_usb/type)
echo status: $(cat /sys/class/power_supply/twl4030_usb/status 2>/dev/null)
echo volt: $(cat /sys/class/power_supply/twl4030_usb/voltage_now 2>/dev/null)uV
echo current: $(cat /sys/class/power_supply/twl4030_usb/current_now 2>/dev/null)uA
echo ID: $(cat /sys/devices/platform/omap_i2c.1/i2c-1/1-0048/twl4030_usb/id 2>/dev/null)

echo
echo "AC Charger"
echo "============"
echo online: $(cat /sys/class/power_supply/twl4030_ac/online 2>/dev/null)
echo type: $(cat /sys/class/power_supply/twl4030_ac/type 2>/dev/null)
echo status: $(cat /sys/class/power_supply/twl4030_ac/status 2>/dev/null)
echo volt: $(cat /sys/class/power_supply/twl4030_ac/voltage_now 2>/dev/null)uV
echo current: $(cat /sys/class/power_supply/twl4030_ac/current_now 2>/dev/null)uA

# see http://www.mjmwired.net/kernel/Documentation/hwmon/twl4030-madc-hwmon
echo
echo "Main Battery"
echo "============"
VOLT=$(cat /sys/devices/platform/twl4030_madc_hwmon/in12_input)
echo volt: ${VOLT}mV ca. $(expr \( "$VOLT" - 3300 \) \* 100 / 950)%
echo current: $(cat /sys/devices/platform/twl4030_madc_hwmon/curr10_input)mA
echo temp: $(cat /sys/devices/platform/twl4030_madc_hwmon/temp1_input)°C
echo type: $(cat /sys/devices/platform/twl4030_madc_hwmon/in0_input)mV
echo ADC7: $(cat /sys/devices/platform/twl4030_madc_hwmon/in7_input)mV	# MICSENSE
echo VBUS: $(cat /sys/devices/platform/twl4030_madc_hwmon/in8_input)mV
echo VCHG: $(cat /sys/devices/platform/twl4030_madc_hwmon/in11_input)mV

echo
echo "Backup battery"
echo "=============="
echo volt: $(cat /sys/devices/platform/twl4030_madc_hwmon/in9_input)mV

echo
echo "BQ27000 (if HDQ works)"
echo "======================"
echo present: $(cat /sys/class/power_supply/bq27000-battery/present 2>/dev/null)
echo type: $(cat /sys/class/power_supply/bq27000-battery/type 2>/dev/null)
echo technology: $(cat /sys/class/power_supply/bq27000-battery/technology 2>/dev/null)
echo capacity: $(cat /sys/class/power_supply/bq27000-battery/capacity 2>/dev/null)%
echo status: $(cat /sys/class/power_supply/bq27000-battery/status 2>/dev/null)
echo level: $(cat /sys/class/power_supply/bq27000-battery/capacity_level 2>/dev/null)
echo volt: $(cat /sys/class/power_supply/bq27000-battery/voltage_now 2>/dev/null)uV
echo current: $(cat /sys/class/power_supply/bq27000-battery/current_now 2>/dev/null)uA
echo temp: $(cat /sys/class/power_supply/bq27000-battery/temp 2>/dev/null)/10°C
echo charge: $(cat /sys/class/power_supply/bq27000-battery/charge_now 2>/dev/null)uAh
echo full: $(cat /sys/class/power_supply/bq27000-battery/charge_full 2>/dev/null)uAh
echo design: $(cat /sys/class/power_supply/bq27000-battery/charge_full_design 2>/dev/null)uAh
echo energy: "$(cat /sys/class/power_supply/bq27000-battery/energy 2>/dev/null)J?"
echo power: "$(cat /sys/class/power_supply/bq27000-battery/power 2>/dev/null)W?"
echo cycles: $(cat /sys/class/power_supply/bq27000-battery/cycle_count 2>/dev/null)
echo health: $(cat /sys/class/power_supply/bq27000-battery/health 2>/dev/null)
echo discharge: $(cat /sys/class/power_supply/bq27000-battery/time_to_empty_avg 2>/dev/null)s to empty
echo remaining: $(cat /sys/class/power_supply/bq27000-battery/time_to_empty_now 2>/dev/null)s to "?"
echo charging: $(cat /sys/class/power_supply/bq27000-battery/time_to_full_now 2>/dev/null)s to full
;;

3.[1-9]?.* )	# 3.14 or later with device tree

echo "USB Charger"
echo "============"
echo online: $(cat /sys/class/power_supply/twl4030_usb/online 2>/dev/null)
echo type: $(cat /sys/class/power_supply/twl4030_usb/type)
echo status: $(cat /sys/class/power_supply/twl4030_usb/status 2>/dev/null)
echo volt: $(cat /sys/class/power_supply/twl4030_usb/voltage_now 2>/dev/null)uV
echo current: $(cat /sys/class/power_supply/twl4030_usb/current_now 2>/dev/null)uA
echo ID: $(cat /dev/usb_id 2>/dev/null)
echo max_current: $(cat /dev/usb_max_current 2>/dev/null)uA

echo
echo "AC Charger"
echo "============"
echo online: $(cat /sys/class/power_supply/twl4030_ac/online 2>/dev/null)
echo type: $(cat /sys/class/power_supply/twl4030_ac/type 2>/dev/null)
echo status: $(cat /sys/class/power_supply/twl4030_ac/status 2>/dev/null)
echo volt: $(cat /sys/class/power_supply/twl4030_ac/voltage_now 2>/dev/null)uV
echo current: $(cat /sys/class/power_supply/twl4030_ac/current_now 2>/dev/null)uA

# see http://www.mjmwired.net/kernel/Documentation/hwmon/twl4030-madc-hwmon
echo
echo "Main Battery"
echo "============"
VOLT=$(cat /sys/devices/madc-hwmon*/in12_input)
echo volt: ${VOLT}mV ca. $(expr \( "$VOLT" - 3300 \) \* 100 / 950)%
echo current: $(cat /sys/devices/madc-hwmon*/curr10_input)mA
echo temp: $(cat /sys/devices/madc-hwmon*/temp1_input)°C
echo type: $(cat /sys/devices/madc-hwmon*/in0_input)mV
echo ADC7: $(cat /sys/devices/madc-hwmon*/in7_input)mV	# MICSENSE
echo VBUS: $(cat /sys/devices/madc-hwmon*/in8_input)mV
echo VCHG: $(cat /sys/devices/madc-hwmon*/in11_input)mV

echo
echo "Backup battery"
echo "=============="
echo volt: $(cat /sys/devices/madc-hwmon*/in9_input)mV

echo
echo "BQ27000 (if HDQ works)"
echo "======================"
echo present: $(cat /sys/class/power_supply/bq27000-battery/present 2>/dev/null)
echo type: $(cat /sys/class/power_supply/bq27000-battery/type 2>/dev/null)
echo technology: $(cat /sys/class/power_supply/bq27000-battery/technology 2>/dev/null)
echo capacity: $(cat /sys/class/power_supply/bq27000-battery/capacity 2>/dev/null)%
echo status: $(cat /sys/class/power_supply/bq27000-battery/status 2>/dev/null)
echo level: $(cat /sys/class/power_supply/bq27000-battery/capacity_level 2>/dev/null)
echo volt: $(cat /sys/class/power_supply/bq27000-battery/voltage_now 2>/dev/null)uV
echo current: $(cat /sys/class/power_supply/bq27000-battery/current_now 2>/dev/null)uA
echo temp: $(cat /sys/class/power_supply/bq27000-battery/temp 2>/dev/null)/10°C
echo charge: $(cat /sys/class/power_supply/bq27000-battery/charge_now 2>/dev/null)uAh
echo full: $(cat /sys/class/power_supply/bq27000-battery/charge_full 2>/dev/null)uAh
echo design: $(cat /sys/class/power_supply/bq27000-battery/charge_full_design 2>/dev/null)uAh
echo energy: "$(cat /sys/class/power_supply/bq27000-battery/energy 2>/dev/null)J?"
echo power: "$(cat /sys/class/power_supply/bq27000-battery/power 2>/dev/null)W?"
echo cycles: $(cat /sys/class/power_supply/bq27000-battery/cycle_count 2>/dev/null)
echo health: $(cat /sys/class/power_supply/bq27000-battery/health 2>/dev/null)
echo discharge: $(cat /sys/class/power_supply/bq27000-battery/time_to_empty_avg 2>/dev/null)s to empty
echo remaining: $(cat /sys/class/power_supply/bq27000-battery/time_to_empty_now 2>/dev/null)s to "?"
echo charging: $(cat /sys/class/power_supply/bq27000-battery/time_to_full_now 2>/dev/null)s to full
;;

esac